{% extends "base.html" %}

{% block title %}URL Analysis Report - {{ results.url }}{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 py-8">
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Modern Header -->
    <div class="relative mb-8">
        <div class="absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-3xl blur-xl"></div>
        <div class="relative bg-gray-900/50 backdrop-blur-xl rounded-3xl p-8 border border-gray-700/30 shadow-2xl">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
                <div class="flex items-center gap-4">
                    <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg shadow-blue-500/20">
                        <i class="fas fa-link text-white text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400">URL Analysis Report</h1>
                        <p class="text-gray-400 mt-2 flex items-center gap-2">
                            <i class="fas fa-globe text-blue-400"></i>
                            <span class="truncate max-w-md">{{ results.url }}</span>
                        </p>
                    </div>
                </div>
                <div class="flex flex-col items-end gap-2">
                    <div class="flex items-center gap-2 text-gray-400 text-sm">
                        <i class="fas fa-calendar text-blue-400"></i>
                        <span>{{ current_time }}</span>
                    </div>
                    <div class="flex items-center gap-2 text-gray-400 text-sm">
                        <i class="fas fa-shield-alt text-purple-400"></i>
                        <span>Security Analysis Complete</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Final Result Card -->
    <div class="relative mb-8">
        <div class="absolute inset-0 bg-gradient-to-r {% if results.final.status %}from-green-500/5 to-emerald-500/5{% else %}from-red-500/5 to-orange-500/5{% endif %} rounded-3xl blur-xl"></div>
        <div class="relative bg-gray-900/30 backdrop-blur-xl rounded-3xl p-8 border border-gray-700/30 shadow-xl">
            <div class="flex flex-col lg:flex-row items-center justify-between gap-8">
                <div class="flex items-start gap-6 flex-1">
                    <div class="w-20 h-20 rounded-2xl bg-gradient-to-br {% if results.final.status %}from-green-500/30 to-emerald-600/30{% else %}from-red-500/30 to-orange-600/30{% endif %} flex items-center justify-center border border-{% if results.final.status %}green{% else %}red{% endif %}-500/30">
                        <i class="fas {% if results.final.status %}fa-shield-check{% else %}fa-shield-exclamation{% endif %} {% if results.final.status %}text-green-400{% else %}text-red-400{% endif %} text-3xl"></i>
                    </div>
                    <div class="flex-1">
                        <h2 class="text-2xl font-bold text-white mb-3 flex items-center gap-3">
                            <span class="bg-clip-text text-transparent bg-gradient-to-r {% if results.final.status %}from-green-400 to-emerald-300{% else %}from-red-400 to-orange-300{% endif %}">Final Result</span>
                        </h2>
                        <p class="text-2xl font-bold {% if results.final.status %}text-green-400{% else %}text-red-400{% endif %} mb-4">{{ results.final.message }}</p>
                        <p class="text-gray-300 leading-relaxed">
                            {% if results.final.status %}
                            <i class="fas fa-check-circle text-green-400 mr-2"></i>
                            This URL appears safe according to our comprehensive analysis. The site has passed all security checks.
                            {% else %}
                            <i class="fas fa-exclamation-triangle text-red-400 mr-2"></i>
                            This URL is flagged as suspicious and may pose a security risk. Avoid visiting this site or entering personal information.
                            {% endif %}
                        </p>
                    </div>
                </div>
                <div class="flex flex-col items-center gap-4">
                    <div class="px-8 py-4 rounded-2xl text-2xl font-bold backdrop-blur-sm border
                        {% if results.final.status %} 
                        bg-green-900/30 text-green-300 border-green-500/30 shadow-lg shadow-green-500/10
                        {% else %} 
                        bg-red-900/30 text-red-300 border-red-500/30 shadow-lg shadow-red-500/10
                        {% endif %}">
                        {% if results.final.status %}SAFE{% else %}UNSAFE{% endif %}
                    </div>
                    <div class="text-center">
                        <div class="text-sm text-gray-400 mb-1">Security Level</div>
                        <div class="flex gap-1">
                            {% for i in range(5) %}
                            <div class="w-8 h-2 rounded-full {% if results.final.status %}{% if i < 4 %}bg-green-500{% else %}bg-gray-700{% endif %}{% else %}{% if i < 1 %}bg-red-500{% else %}bg-gray-700{% endif %}{% endif %}"></div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Analysis Details Grid -->
    <div class="relative mb-8">
        <div class="absolute inset-0 bg-gradient-to-r from-cyan-500/5 to-blue-500/5 rounded-3xl blur-xl"></div>
        <div class="relative bg-gray-900/30 backdrop-blur-xl rounded-3xl p-8 border border-gray-700/30 shadow-xl">
            <h2 class="text-2xl font-bold text-white mb-8 flex items-center gap-3">
                <i class="fas fa-chart-bar text-cyan-400"></i>
                <span class="bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 to-blue-300">Security Analysis Details</span>
            </h2>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- SSL Certificate Check -->
                <div class="bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/30 hover:border-{% if results.ssl.status %}green{% else %}red{% endif %}-500/50 transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="w-14 h-14 rounded-xl bg-gradient-to-br {% if results.ssl.status %}from-green-500/30 to-emerald-600/30{% else %}from-red-500/30 to-orange-600/30{% endif %} flex items-center justify-center border border-{% if results.ssl.status %}green{% else %}red{% endif %}-500/30">
                            <i class="fas fa-shield-alt {% if results.ssl.status %}text-green-400{% else %}text-red-400{% endif %} text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-semibold text-lg text-white mb-1">SSL Certificate</h3>
                            <p class="text-xs text-gray-400 uppercase tracking-wider">Transport Security</p>
                        </div>
                    </div>
                    <p class="text-gray-300 text-sm mb-4 min-h-[60px]">{{ results.ssl.message }}</p>
                    <div class="flex items-center justify-between">
                        <span class="px-4 py-2 rounded-lg text-sm font-semibold backdrop-blur-sm border
                            {% if results.ssl.status %} 
                            bg-green-900/30 text-green-300 border-green-500/30
                            {% else %} 
                            bg-red-900/30 text-red-300 border-red-500/30
                            {% endif %}">
                            {% if results.ssl.status %}SECURE{% else %}INSECURE{% endif %}
                        </span>
                        <i class="fas fa-{% if results.ssl.status %}check-circle text-green-400{% else %}times-circle text-red-400{% endif %}"></i>
                    </div>
                </div>

                <!-- AI Classification Model -->
                <div class="bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/30 hover:border-{% if results.model.prediction == 1 %}green{% else %}red{% endif %}-500/50 transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="w-14 h-14 rounded-xl bg-gradient-to-br {% if results.model.prediction == 1 %}from-green-500/30 to-emerald-600/30{% else %}from-red-500/30 to-orange-600/30{% endif %} flex items-center justify-center border border-{% if results.model.prediction == 1 %}green{% else %}red{% endif %}-500/30">
                            <i class="fas fa-robot {% if results.model.prediction == 1 %}text-green-400{% else %}text-red-400{% endif %} text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-semibold text-lg text-white mb-1">AI Classification</h3>
                            <p class="text-xs text-gray-400 uppercase tracking-wider">Machine Learning</p>
                        </div>
                    </div>
                    <p class="text-gray-300 text-sm mb-4 min-h-[60px]">AI Model Classification: <span class="font-semibold {% if results.model.prediction == 1 %}text-green-400{% else %}text-red-400{% endif %}">{{ results.model.label }}</span></p>
                    <div class="flex items-center justify-between">
                        <span class="px-4 py-2 rounded-lg text-sm font-semibold backdrop-blur-sm border
                            {% if results.model.prediction == 1 %} 
                            bg-green-900/30 text-green-300 border-green-500/30
                            {% else %} 
                            bg-red-900/30 text-red-300 border-red-500/30
                            {% endif %}">
                            {{ results.model.label }}
                        </span>
                        <i class="fas fa-{% if results.model.prediction == 1 %}check-circle text-green-400{% else %}times-circle text-red-400{% endif %}"></i>
                    </div>
                </div>

                <!-- Text Content Analysis -->
                <div class="bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/30 hover:border-{% if results.content.status %}green{% else %}red{% endif %}-500/50 transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="w-14 h-14 rounded-xl bg-gradient-to-br {% if results.content.status %}from-green-500/30 to-emerald-600/30{% else %}from-red-500/30 to-orange-600/30{% endif %} flex items-center justify-center border border-{% if results.content.status %}green{% else %}red{% endif %}-500/30">
                            <i class="fas fa-text-height {% if results.content.status %}text-green-400{% else %}text-red-400{% endif %} text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-semibold text-lg text-white mb-1">Content Analysis</h3>
                            <p class="text-xs text-gray-400 uppercase tracking-wider">Text & Keywords</p>
                        </div>
                    </div>
                    <p class="text-gray-300 text-sm mb-4 min-h-[60px]">{{ results.content.message }}</p>
                    <div class="flex items-center justify-between">
                        <span class="px-4 py-2 rounded-lg text-sm font-semibold backdrop-blur-sm border
                            {% if results.content.status %} 
                            bg-green-900/30 text-green-300 border-green-500/30
                            {% else %} 
                            bg-red-900/30 text-red-300 border-red-500/30
                            {% endif %}">
                            {% if results.content.status %}SAFE{% else %}SUSPICIOUS{% endif %}
                        </span>
                        <i class="fas fa-{% if results.content.status %}check-circle text-green-400{% else %}times-circle text-red-400{% endif %}"></i>
                    </div>
                </div>

                <!-- HTML Analysis -->
                <div class="bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/30 hover:border-{% if results.html.status %}green{% else %}red{% endif %}-500/50 transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="w-14 h-14 rounded-xl bg-gradient-to-br {% if results.html.status %}from-green-500/30 to-emerald-600/30{% else %}from-red-500/30 to-orange-600/30{% endif %} flex items-center justify-center border border-{% if results.html.status %}green{% else %}red{% endif %}-500/30">
                            <i class="fas fa-code {% if results.html.status %}text-green-400{% else %}text-red-400{% endif %} text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-semibold text-lg text-white mb-1">HTML Structure</h3>
                            <p class="text-xs text-gray-400 uppercase tracking-wider">Page Structure</p>
                        </div>
                    </div>
                    <p class="text-gray-300 text-sm mb-4 min-h-[60px]">{{ results.html.message }}</p>
                    <div class="flex items-center justify-between">
                        <span class="px-4 py-2 rounded-lg text-sm font-semibold backdrop-blur-sm border
                            {% if results.html.status %} 
                            bg-green-900/30 text-green-300 border-green-500/30
                            {% else %} 
                            bg-red-900/30 text-red-300 border-red-500/30
                            {% endif %}">
                            {% if results.html.status %}SAFE{% else %}SUSPICIOUS{% endif %}
                        </span>
                        <i class="fas fa-{% if results.html.status %}check-circle text-green-400{% else %}times-circle text-red-400{% endif %}"></i>
                    </div>
                </div>

                <!-- JavaScript Analysis -->
                <div class="bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/30 hover:border-{% if results.javascript.status %}green{% else %}red{% endif %}-500/50 transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="w-14 h-14 rounded-xl bg-gradient-to-br {% if results.javascript.status %}from-green-500/30 to-emerald-600/30{% else %}from-red-500/30 to-orange-600/30{% endif %} flex items-center justify-center border border-{% if results.javascript.status %}green{% else %}red{% endif %}-500/30">
                            <i class="fab fa-js {% if results.javascript.status %}text-green-400{% else %}text-red-400{% endif %} text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-semibold text-lg text-white mb-1">JavaScript Code</h3>
                            <p class="text-xs text-gray-400 uppercase tracking-wider">Script Analysis</p>
                        </div>
                    </div>
                    <p class="text-gray-300 text-sm mb-4 min-h-[60px]">{{ results.javascript.message }}</p>
                    <div class="flex items-center justify-between">
                        <span class="px-4 py-2 rounded-lg text-sm font-semibold backdrop-blur-sm border
                            {% if results.javascript.status %} 
                            bg-green-900/30 text-green-300 border-green-500/30
                            {% else %} 
                            bg-red-900/30 text-red-300 border-red-500/30
                            {% endif %}">
                            {% if results.javascript.status %}SAFE{% else %}SUSPICIOUS{% endif %}
                        </span>
                        <i class="fas fa-{% if results.javascript.status %}check-circle text-green-400{% else %}times-circle text-red-400{% endif %}"></i>
                    </div>
                </div>

                <!-- VirusTotal Security Scan -->
                <div class="bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/30 hover:border-{% if results.vt.status == True %}green{% elif results.vt.status == False %}red{% else %}yellow{% endif %}-500/50 transition-all duration-300 transform hover:-translate-y-1 lg:col-span-3">
                    <div class="flex items-start gap-4 mb-6">
                        <div class="w-14 h-14 rounded-xl bg-gradient-to-br {% if results.vt.status == True %}from-green-500/30 to-emerald-600/30{% elif results.vt.status == False %}from-red-500/30 to-orange-600/30{% else %}from-yellow-500/30 to-amber-600/30{% endif %} flex items-center justify-center border border-{% if results.vt.status == True %}green{% elif results.vt.status == False %}red{% else %}yellow{% endif %}-500/30">
                            <i class="fas fa-shield-virus {% if results.vt.status == True %}text-green-400{% elif results.vt.status == False %}text-red-400{% else %}text-yellow-400{% endif %} text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center justify-between mb-1">
                                <h3 class="font-semibold text-lg text-white">VirusTotal Security Check</h3>
                                <span class="px-4 py-2 rounded-lg text-sm font-semibold backdrop-blur-sm border
                                    {% if results.vt.status == True %} 
                                    bg-green-900/30 text-green-300 border-green-500/30
                                    {% elif results.vt.status == False %} 
                                    bg-red-900/30 text-red-300 border-red-500/30
                                    {% else %}
                                    bg-yellow-900/30 text-yellow-300 border-yellow-500/30
                                    {% endif %}">
                                    {% if results.vt.status == True %}SAFE
                                    {% elif results.vt.status == False %}MALICIOUS
                                    {% else %}UNKNOWN{% endif %}
                                </span>
                            </div>
                            <p class="text-xs text-gray-400 uppercase tracking-wider">Third-Party Verification</p>
                        </div>
                    </div>
                    
                    <!-- Security Verdict -->
                    <div class="bg-gray-900/50 rounded-xl p-5 mb-4">
                        <h4 class="text-white font-semibold mb-3 flex items-center gap-2">
                            <i class="fas fa-gavel text-blue-400"></i>
                            Security Verdict
                        </h4>
                        <div class="flex items-center gap-3 mb-4">
                            {% if results.vt.status == True %}
                                <i class="fas fa-shield-check text-green-400 text-2xl"></i>
                                <span class="text-green-400 font-medium">No security threats detected by VirusTotal</span>
                            {% elif results.vt.status == False %}
                                <i class="fas fa-exclamation-triangle text-red-400 text-2xl"></i>
                                <span class="text-red-400 font-medium">Security threats detected by VirusTotal</span>
                            {% else %}
                                <i class="fas fa-question-circle text-yellow-400 text-2xl"></i>
                                <span class="text-yellow-400 font-medium">VirusTotal analysis not available</span>
                            {% endif %}
                        </div>
                        <div class="text-gray-300 text-sm bg-gray-800/50 rounded-lg p-3">
                            {% if results.vt.message %}
                                {{ results.vt.message|safe }}
                            {% else %}
                                <p>No scan results available</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Risk Score Bar -->
                    <div class="bg-gray-900/50 rounded-xl p-5">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-white font-semibold">Threat Level</span>
                            <span class="text-sm {% if results.vt.status == True %}text-green-400{% elif results.vt.status == False %}text-red-400{% else %}text-yellow-400{% endif %} font-bold">
                                {% if results.vt.status == True %}Low Risk
                                {% elif results.vt.status == False %}High Risk
                                {% else %}Unknown{% endif %}
                            </span>
                        </div>
                        <div class="w-full bg-gray-700/50 rounded-full h-4 relative overflow-hidden">
                            <div class="absolute top-0 left-0 h-full rounded-full transition-all duration-500
                                {% if results.vt.status == True %}bg-gradient-to-r from-green-500 to-emerald-600
                                {% elif results.vt.status == False %}bg-gradient-to-r from-red-500 to-orange-600
                                {% else %}bg-gradient-to-r from-yellow-500 to-amber-600{% endif %}"
                                style="width: {% if results.vt.status == True %}15%{% elif results.vt.status == False %}90%{% else %}50%{% endif %}">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Security Recommendations -->
    <div class="relative mb-8">
        <div class="absolute inset-0 bg-gradient-to-r from-yellow-500/5 to-orange-500/5 rounded-3xl blur-xl"></div>
        <div class="relative bg-gray-900/30 backdrop-blur-xl rounded-3xl p-8 border border-gray-700/30 shadow-xl">
            <h2 class="text-2xl font-bold text-white mb-8 flex items-center gap-3">
                <i class="fas fa-lightbulb text-yellow-400"></i>
                <span class="bg-clip-text text-transparent bg-gradient-to-r from-yellow-400 to-orange-300">Security Recommendations</span>
            </h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-blue-500/30">
                    <h3 class="font-semibold text-xl text-blue-400 mb-6 flex items-center gap-2">
                        <i class="fas fa-shield-alt"></i> Preventive Measures
                    </h3>
                    <ul class="space-y-4">
                        <li class="flex items-start gap-3 p-3 rounded-lg bg-gray-900/30 hover:bg-gray-900/50 transition-colors">
                            <i class="fas fa-check-circle text-green-400 mt-1 text-lg"></i>
                            <span class="text-gray-300">Keep software and systems updated</span>
                        </li>
                        <li class="flex items-start gap-3 p-3 rounded-lg bg-gray-900/30 hover:bg-gray-900/50 transition-colors">
                            <i class="fas fa-check-circle text-green-400 mt-1 text-lg"></i>
                            <span class="text-gray-300">Use firewalls and WAF applications</span>
                        </li>
                        <li class="flex items-start gap-3 p-3 rounded-lg bg-gray-900/30 hover:bg-gray-900/50 transition-colors">
                            <i class="fas fa-check-circle text-green-400 mt-1 text-lg"></i>
                            <span class="text-gray-300">Implement strong password policies</span>
                        </li>
                        <li class="flex items-start gap-3 p-3 rounded-lg bg-gray-900/30 hover:bg-gray-900/50 transition-colors">
                            <i class="fas fa-check-circle text-green-400 mt-1 text-lg"></i>
                            <span class="text-gray-300">Enable two-factor authentication</span>
                        </li>
                        <li class="flex items-start gap-3 p-3 rounded-lg bg-gray-900/30 hover:bg-gray-900/50 transition-colors">
                            <i class="fas fa-check-circle text-green-400 mt-1 text-lg"></i>
                            <span class="text-gray-300">Conduct regular security audits</span>
                        </li>
                    </ul>
                </div>

                <div class="bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-red-500/30">
                    <h3 class="font-semibold text-xl text-red-400 mb-6 flex items-center gap-2">
                        <i class="fas fa-exclamation-triangle"></i> Remediation Measures
                    </h3>
                    <ul class="space-y-4">
                        <li class="flex items-start gap-3 p-3 rounded-lg bg-gray-900/30 hover:bg-gray-900/50 transition-colors">
                            <i class="fas fa-tools text-red-400 mt-1 text-lg"></i>
                            <span class="text-gray-300">Fix discovered vulnerabilities immediately</span>
                        </li>
                        <li class="flex items-start gap-3 p-3 rounded-lg bg-gray-900/30 hover:bg-gray-900/50 transition-colors">
                            <i class="fas fa-user-lock text-red-400 mt-1 text-lg"></i>
                            <span class="text-gray-300">Review user permissions and privileges</span>
                        </li>
                        <li class="flex items-start gap-3 p-3 rounded-lg bg-gray-900/30 hover:bg-gray-900/50 transition-colors">
                            <i class="fas fa-file-alt text-red-400 mt-1 text-lg"></i>
                            <span class="text-gray-300">Check logs for possible intrusions</span>
                        </li>
                        <li class="flex items-start gap-3 p-3 rounded-lg bg-gray-900/30 hover:bg-gray-900/50 transition-colors">
                            <i class="fas fa-lock text-red-400 mt-1 text-lg"></i>
                            <span class="text-gray-300">Encrypt sensitive data</span>
                        </li>
                        <li class="flex items-start gap-3 p-3 rounded-lg bg-gray-900/30 hover:bg-gray-900/50 transition-colors">
                            <i class="fas fa-database text-red-400 mt-1 text-lg"></i>
                            <span class="text-gray-300">Create regular backups</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Actions -->
    <div class="relative mb-8">
        <div class="absolute inset-0 bg-gradient-to-r from-indigo-500/5 to-purple-500/5 rounded-3xl blur-xl"></div>
        <div class="relative bg-gray-900/30 backdrop-blur-xl rounded-3xl p-8 border border-gray-700/30 shadow-xl">
            <h2 class="text-2xl font-bold text-white mb-8 text-center flex items-center justify-center gap-3">
                <i class="fas fa-tasks text-indigo-400"></i>
                <span class="bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-purple-300">Report Actions</span>
            </h2>

            <div class="flex flex-wrap gap-4 justify-center">
                <a href="{{ url_for('url_analysis') }}"
                   class="px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-indigo-800 transition-all transform hover:-translate-y-1 hover:shadow-lg hover:shadow-blue-500/20 flex items-center justify-center gap-2">
                    <i class="fas fa-redo"></i> New Analysis
                </a>
                
                <a href="{{ url_for('dashboard') }}"
                   class="px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-700 text-white font-semibold rounded-xl hover:from-indigo-700 hover:to-purple-800 transition-all transform hover:-translate-y-1 hover:shadow-lg hover:shadow-indigo-500/20 flex items-center justify-center gap-2">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </a>
                
                <button onclick="printReport()"
                        class="px-8 py-4 bg-gradient-to-r from-green-600 to-teal-600 text-white font-semibold rounded-xl hover:from-green-700 hover:to-teal-700 transition-all transform hover:-translate-y-1 hover:shadow-lg hover:shadow-green-500/20 flex items-center justify-center gap-2">
                    <i class="fas fa-print"></i> Print
                </button>

                <button onclick="downloadHTML()"
                        class="px-8 py-4 bg-gradient-to-r from-amber-600 to-orange-600 text-white font-semibold rounded-xl hover:from-amber-700 hover:to-orange-700 transition-all transform hover:-translate-y-1 hover:shadow-lg hover:shadow-amber-500/20 flex items-center justify-center gap-2">
                    <i class="fas fa-download"></i> Download
                </button>
                
                <button id="share-report-btn"
                        class="px-8 py-4 bg-gradient-to-r from-cyan-600 to-blue-700 text-white font-semibold rounded-xl hover:from-cyan-700 hover:to-blue-800 transition-all transform hover:-translate-y-1 hover:shadow-lg hover:shadow-cyan-500/20 flex items-center justify-center gap-2">
                    <i class="fas fa-share-alt"></i> Share
                </button>
            
                
                <button onclick="confirmDelete('url', '{{ analysis.id }}')"
                        class="px-8 py-4 bg-gradient-to-r from-red-600 to-red-800 text-white font-semibold rounded-xl hover:from-red-700 hover:to-red-900 transition-all transform hover:-translate-y-1 hover:shadow-lg hover:shadow-red-500/20 flex items-center justify-center gap-2">
                    <i class="fas fa-trash-alt"></i> Delete
                </button>
            </div>
        </div>
    </div>
</div>
<script>
function confirmDelete(reportType, reportId) {
    if (confirm('Are you sure you want to delete this report? This action cannot be undone.')) {
        deleteReport(reportType, reportId);
    }
}

function deleteReport(reportType, reportId) {
    let endpoint = '';
    switch(reportType) {
        case 'sample':
            endpoint = `/delete_sample_report/${reportId}`;
            break;
        case 'web':
            endpoint = `/delete_web_report/${reportId}`;
            break;
        case 'url':
            endpoint = `/delete_url_report/${reportId}`;
            break;
        case 'code':
            endpoint = `/delete_code_report/${reportId}`;
            break;
        case 'pdf':
            endpoint = `/delete_pdf_report/${reportId}`;
            break;
        default:
            alert('Unknown report type');
            return;
    }

    fetch(endpoint, {
        method: 'DELETE',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token() }}'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('تم حذف التقرير بنجاح');
            window.location.href = "/dashboard";
        } else {
            alert('فشل في حذف التقرير: ' + data.message);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('حدث خطأ أثناء محاولة الحذف');
    });
}
</script>
<script>
    // فتح نموذج المشاركة
    document.getElementById('share-report-btn').addEventListener('click', function() {
        const reportUrl = window.location.href;
        navigator.clipboard.writeText(reportUrl).then(() => {
            alert('تم نسخ رابط التقرير إلى الحافظة: ' + reportUrl);
        }).catch(err => {
            console.error('Failed to copy: ', err);
            alert('تعذر نسخ الرابط. يرجى المحاولة مرة أخرى.');
        });
    });
    
    // طباعة التقرير
    function printReport() {
        window.print();
    }
    
    // تحميل التقرير بتنسيق HTML
    function downloadHTML() {
        const reportContent = document.getElementById('report-content').outerHTML;
        const fullHTML = `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تقرير تحليل الرابط - {{ results.url }}</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
        body { font-family: 'Cairo', sans-serif; background-color: #111827; color: white; }
        .gradient-bg { background: linear-gradient(90deg, #3B82F6 0%, #8B5CF6 100%); }
        .card-hover { transition: all 0.3s ease; }
    </style>
</head>
<body class="bg-gray-900 text-white p-4">
    ${reportContent}
</body>
</html>`;
        
        const blob = new Blob([fullHTML], {type: 'text/html'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'تقرير_تحليل_الرابط_{{ results.url|replace("://", "_")|replace("/", "_")|replace(".", "_") }}.html';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }
</script>

<!-- طباعة CSS -->
<style>
@media print {
    body * { visibility: hidden; }
    #report-content, #report-content * { visibility: visible; }
    #report-content { position: absolute; left: 0; top: 0; width: 100%; }
    .card-hover { box-shadow: none; transform: none; }
}
</style>

<style>
    .card-hover {
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .card-hover:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(139, 92, 246, 0.3);
    }

    .gradient-bg {
        background: linear-gradient(90deg, #3B82F6 0%, #8B5CF6 100%);
    }
</style>
{% endblock %}